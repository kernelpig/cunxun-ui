!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,r){return void 0===r&&(r="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(r)}:e(window.jQuery)}(function(e){e.extend(e.FE.DEFAULTS,{wordDeniedTags:[],wordDeniedAttrs:[],wordAllowedStyleProps:["font-family","font-size","background","color","width","text-align","vertical-align","background-color","padding","margin","height","margin-top","margin-left","margin-right","margin-bottom","text-decoration","font-weight","font-style"],wordPasteModal:!0}),e.FE.PLUGINS.wordPaste=function(t){function r(){t.events.on("paste.wordPaste",function(e){return S=e,t.opts.wordPasteModal?n():a(!0),!1})}function i(){var e='<div class="fr-word-paste-modal" style="padding: 20px 20px 10px 20px;">';return e+='<p style="text-align: left;">'+t.language.translate("The pasted content is coming from a Microsoft Word document. Do you want to keep the format or clean it up?")+"</p>",e+='<div style="text-align: right; margin-top: 50px;"><button class="fr-remove-word fr-command">'+t.language.translate("Clean")+'</button> <button class="fr-keep-word fr-command">'+t.language.translate("Keep")+"</button></div>",e+="</div>"}function n(){if(!T){var r='<h4><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 74.95 73.23" style="height: 25px; vertical-align: text-bottom; margin-right: 5px; display: inline-block"><defs><style>.a{fill:#2a5699;}.b{fill:#fff;}</style></defs><path class="a" d="M615.15,827.22h5.09V834c9.11.05,18.21-.09,27.32.05a2.93,2.93,0,0,1,3.29,3.25c.14,16.77,0,33.56.09,50.33-.09,1.72.17,3.63-.83,5.15-1.24.89-2.85.78-4.3.84-8.52,0-17,0-25.56,0v6.81h-5.32c-13-2.37-26-4.54-38.94-6.81q0-29.8,0-59.59c13.05-2.28,26.11-4.5,39.17-6.83Z" transform="translate(-575.97 -827.22)"/><path class="b" d="M620.24,836.59h28.1v54.49h-28.1v-6.81h22.14v-3.41H620.24v-4.26h22.14V873.2H620.24v-4.26h22.14v-3.41H620.24v-4.26h22.14v-3.41H620.24v-4.26h22.14v-3.41H620.24V846h22.14v-3.41H620.24Zm-26.67,15c1.62-.09,3.24-.16,4.85-.25,1.13,5.75,2.29,11.49,3.52,17.21,1-5.91,2-11.8,3.06-17.7,1.7-.06,3.41-.15,5.1-.26-1.92,8.25-3.61,16.57-5.71,24.77-1.42.74-3.55,0-5.24.09-1.13-5.64-2.45-11.24-3.47-16.9-1,5.5-2.29,10.95-3.43,16.42q-2.45-.13-4.92-.3c-1.41-7.49-3.07-14.93-4.39-22.44l4.38-.18c.88,5.42,1.87,10.82,2.64,16.25,1.2-5.57,2.43-11.14,3.62-16.71Z" transform="translate(-575.97 -827.22)"/></svg> '+t.language.translate("Word Paste Detected")+"</h4>",n=i(),l=t.modals.create(x,r,n),a=l.$body;T=l.$modal,l.$modal.addClass("fr-middle"),t.events.bindClick(a,"button.fr-remove-word",function(){var e=T.data("instance")||t;e.wordPaste.clean()}),t.events.bindClick(a,"button.fr-keep-word",function(){var e=T.data("instance")||t;e.wordPaste.clean(!0)}),t.events.$on(e(t.o_win),"resize",function(){t.modals.resize(x)})}t.modals.show(x),t.modals.resize(x)}function l(){t.modals.hide(x)}function a(e){var r=t.opts.wordAllowedStyleProps;e||(t.opts.wordAllowedStyleProps=[]),S=S.replace(/^\n*/g,"").replace(/^ /g,""),0===S.indexOf("<colgroup>")&&(S="<table>"+S+"</table>"),S=w(S,t.paste.getRtfClipboard()),S=t.paste.removeEmptyTags(S),l(),t.paste.clean(S,!0,!0),t.opts.wordAllowedStyleProps=r}function s(e){var t=e.parentNode;t&&e.parentNode.removeChild(e)}function o(e,t){if(t(e))for(var r=e.firstChild;r;){var i=r,n=r.previousSibling;r=r.nextSibling,o(i,t),i.previousSibling||i.nextSibling||i.parentNode||!r||n==r.previousSibling||!r.parentNode?i.previousSibling||i.nextSibling||i.parentNode||!r||r.previousSibling||r.nextSibling||r.parentNode||(n?r=n.nextSibling?n.nextSibling.nextSibling:null:e.firstChild&&(r=e.firstChild.nextSibling)):r=n?n.nextSibling:e.firstChild}}function d(e){if(!e.getAttribute("style")||!/mso-list:[\s]*l/gi.test(e.getAttribute("style").replace(/\n/gi,"")))return!1;try{if(!e.querySelector('[style="mso-list:Ignore"]'))return!1}catch(t){return!1}return!0}function f(e){return e.getAttribute("style").replace(/\n/gi,"").replace(/.*level([0-9]+?).*/gi,"$1")}function g(e,t){var r=e.cloneNode(!0);if(r.firstElementChild&&"A"==r.firstElementChild.tagName&&(r=r.firstElementChild),-1!=["H1","H2","H3","H4","H5","H6"].indexOf(e.tagName)){var i=document.createElement(e.tagName.toLowerCase());i.setAttribute("style",e.getAttribute("style")),i.innerHTML=r.innerHTML,r.innerHTML=i.outerHTML}o(r,function(e){return e.nodeType==Node.ELEMENT_NODE&&("mso-list:Ignore"==e.getAttribute("style")&&e.parentNode.removeChild(e),C(e,t)),!0});var n=r.innerHTML;return n=n.replace(/<!--[\s\S]*?-->/gi,"")}function u(e,t){var r=/[0-9a-zA-Z]./gi,i=!1;e.firstElementChild&&e.firstElementChild.firstElementChild&&e.firstElementChild.firstElementChild.firstChild&&(i=i||r.test(e.firstElementChild.firstElementChild.firstChild.data||""),!i&&e.firstElementChild.firstElementChild.firstElementChild&&e.firstElementChild.firstElementChild.firstElementChild.firstChild&&(i=i||r.test(e.firstElementChild.firstElementChild.firstElementChild.firstChild.data||"")));var n=i?"ol":"ul",l=f(e),a="<"+n+"><li>"+g(e,t),o=e.nextElementSibling,p=e.parentNode;for(s(e),e=null;o&&d(o);){var m=o.previousElementSibling,c=f(o);if(c>l)a+=u(o,t).outerHTML;else{if(l>c)break;a+="</li><li>"+g(o,t)}if(l=c,o.previousElementSibling||o.nextElementSibling||o.parentNode){var h=o;o=o.nextElementSibling,s(h),h=null}else o=m?m.nextElementSibling:p.firstElementChild}a+="</li></"+n+">";var v=document.createElement("div");v.innerHTML=a;var b=v.firstElementChild;return b}function p(e,t){for(var r=document.createElement(t),i=0;i<e.attributes.length;i++){var n=e.attributes[i].name;r.setAttribute(n,e.getAttribute(n))}return r.innerHTML=e.innerHTML,e.parentNode.replaceChild(r,e),r}function m(r,i){t.node.clearAttributes(r);for(var n=r.firstElementChild,l=0,a=!1,o=null;n;){n.firstElementChild&&-1!=n.firstElementChild.tagName.indexOf("W:")&&(n.innerHTML=n.firstElementChild.innerHTML),o=n.getAttribute("width"),o||a||(a=!0),l+=parseInt(o,10),(!n.firstChild||n.firstChild&&n.firstChild.data==e.FE.UNICODE_NBSP)&&(n.firstChild&&s(n.firstChild),n.innerHTML="<br>");for(var f=n.firstElementChild,g=1==n.children.length;f;)"P"!=f.tagName||d(f)||g&&c(f),f=f.nextElementSibling;if(i){var u=n.getAttribute("class");if(u){u=h(u);var p=u.match(/xl[0-9]+/gi);if(p){var m=p[0],b="."+m;i[b]&&v(n,i[b])}}i.td&&v(n,i.td)}var E=n.getAttribute("style");E&&(E=h(E),E&&";"!=E.slice(-1)&&(E+=";"));var A=n.getAttribute("valign");if(!A&&E){var C=E.match(/vertical-align:.+?[; "]{1,1}/gi);C&&(A=C[C.length-1].replace(/vertical-align:(.+?)[; "]{1,1}/gi,"$1"))}var y=null;if(E){var N=E.match(/text-align:.+?[; "]{1,1}/gi);N&&(y=N[N.length-1].replace(/text-align:(.+?)[; "]{1,1}/gi,"$1")),"general"==y&&(y=null)}var w=null;if(E){var T=E.match(/background:.+?[; "]{1,1}/gi);T&&(w=T[T.length-1].replace(/background:(.+?)[; "]{1,1}/gi,"$1"))}var S=n.getAttribute("colspan"),x=n.getAttribute("rowspan");S&&n.setAttribute("colspan",S),x&&n.setAttribute("rowspan",x),A&&(n.style["vertical-align"]=A),y&&(n.style["text-align"]=y),w&&(n.style["background-color"]=w),o&&n.setAttribute("width",o),n=n.nextElementSibling}for(n=r.firstElementChild;n;)o=n.getAttribute("width"),a?n.removeAttribute("width"):n.setAttribute("width",100*parseInt(o,10)/l+"%"),n=n.nextElementSibling}function c(e){var t=e.parentNode,r=e.getAttribute("align");r&&(t&&"TD"==t.tagName?(t.setAttribute("style",t.getAttribute("style")+"text-align:"+r+";"),e.removeAttribute("align")):(e.style["text-align"]=r,e.removeAttribute("align")))}function h(e){return e.replace(/\n|\r|\n\r|&quot;/g,"")}function v(e,t,r){if(t){var i=e.getAttribute("style");i&&";"!=i.slice(-1)&&(i+=";"),t&&";"!=t.slice(-1)&&(t+=";"),t=t.replace(/\n/gi,"");var n=null;n=r?(i||"")+t:t+(i||""),e.setAttribute("style",n)}}function b(e){var t=e.getAttribute("style");if(t){t=h(t),t&&";"!=t.slice(-1)&&(t+=";");var r=t.match(/(^|\S+?):.+?;{1,1}/gi);if(r){for(var i={},n=0;n<r.length;n++){var l=r[n],a=l.split(":");2==a.length&&("text-align"==a[0]&&"SPAN"==e.tagName||(i[a[0]]=a[1]))}var s="";for(var o in i)if(i.hasOwnProperty(o)){if("font-size"==o&&"pt;"==i[o].slice(-3)){var d=null;try{d=parseFloat(i[o].slice(0,-3),10)}catch(f){}d&&(d=Math.round(1.33*d),i[o]=d+"px;")}s+=o+":"+i[o]}s&&e.setAttribute("style",s)}}}function E(e){for(var t=e.match(/[0-9a-f]{2}/gi),r=[],i=0;i<t.length;i++)r.push(String.fromCharCode(parseInt(t[i],16)));var n=r.join("");return btoa(n)}function A(t,r){if(r){var i;if("IMG"==t.tagName){var n=t.getAttribute("src");if(!n||-1==n.indexOf("file://"))return;i=M[t.getAttribute("v:shapes")]}else i=t.parentNode.getAttribute("o:spid");if(i){var l="hplid"+i.substring(8),a=r.split(l);if(!a||2==a.length){var s=a[1].split("bliptag");if(!(s&&s.length<2)){var o=null;if(-1!=s[0].indexOf("pngblip")?o="image/png":-1!=s[0].indexOf("jpegblip")&&(o="image/jpeg"),o){var d=s[1].split("}");if(!(d&&d.length<2)){var f;if(d.length>2&&-1!=d[0].indexOf("blipuid"))f=d[1].split(" ");else{if(f=d[0].split(" "),f&&f.length<2)return;f.shift()}var g=f.join(""),u=E(g),p="data:"+o+";base64,"+u;"IMG"===t.tagName?(t.src=p,t.setAttribute("data-fr-image-pasted",!0)):e(t.parentNode).before('<img data-fr-image-pasted="true" src="'+p+'" style="'+t.parentNode.getAttribute("style")+'">').remove()}}}}}}}function C(t,r){var i=t.tagName,n=i.toLowerCase();t.firstElementChild&&("I"==t.firstElementChild.tagName?p(t.firstElementChild,"em"):"B"==t.firstElementChild.tagName&&p(t.firstElementChild,"strong"));var l=["SCRIPT","APPLET","EMBED","NOFRAMES","NOSCRIPT"];if(-1!=l.indexOf(i))return s(t),!1;"O:P"==i&&"&nbsp;"==t.innerHTML&&(t.innerHTML=e.FE.INVISIBLE_SPACE);var a=-1,o=["META","LINK","XML","ST1:","O:","W:","FONT"];for(a=0;a<o.length;a++)if(-1!=i.indexOf(o[a]))return t.innerHTML?(t.outerHTML=t.innerHTML,s(t),!1):(s(t),!1);if("TD"!=i){var d=t.getAttribute("class");if(r&&d){d=h(d);var f=d.split(" ");for(a=0;a<f.length;a++){var g=f[a],u=[],b="."+g;u.push(b),b=n+b,u.push(b);for(var E=0;E<u.length;E++)r[u[E]]&&v(t,r[u[E]])}t.removeAttribute("class")}r&&r[n]&&v(t,r[n])}var A=["P","H1","H2","H3","H4","H5","H6","PRE"];if(-1!=A.indexOf(i)){var C=t.getAttribute("class");if(C&&(r&&r[i.toLowerCase()+"."+C]&&v(t,r[i.toLowerCase()+"."+C]),-1!=C.toLowerCase().indexOf("mso"))){var y=h(C);y=y.replace(/[0-9a-z-_]*mso[0-9a-z-_]*/gi,""),y?t.setAttribute("class",y):t.removeAttribute("class")}var N=t.getAttribute("style"),w=null;if(N){var T=N.match(/text-align:.+?[; "]{1,1}/gi);T&&(w=T[T.length-1].replace(/(text-align:.+?[; "]{1,1})/gi,"$1"))}c(t)}if("TR"==i&&m(t,r),"A"==i&&!t.attributes.getNamedItem("href")&&t.innerHTML&&(t.outerHTML=t.innerHTML),"TD"!=i&&"TH"!=i||t.innerHTML||(t.innerHTML="<br>"),"TABLE"==i&&(t.style.width="100%"),t.getAttribute("lang")&&t.removeAttribute("lang"),t.getAttribute("style")&&-1!=t.getAttribute("style").toLowerCase().indexOf("mso")){var S=h(t.getAttribute("style"));S=S.replace(/[0-9a-z-_]*mso[0-9a-z-_]*:.+?(;{1,1}|$)/gi,""),S?t.setAttribute("style",S):t.removeAttribute("style")}return!0}function y(e){var t={},r=e.getElementsByTagName("style");if(r.length){var i=r[0],n=i.innerHTML.match(/[\S ]+\s+{[\s\S]+?}/gi);if(n)for(var l=0;l<n.length;l++){var a=n[l],s=a.replace(/([\S ]+\s+){[\s\S]+?}/gi,"$1"),o=a.replace(/[\S ]+\s+{([\s\S]+?)}/gi,"$1");s=s.replace(/^[\s]|[\s]$/gm,""),o=o.replace(/^[\s]|[\s]$/gm,""),s=s.replace(/\n|\r|\n\r/g,""),o=o.replace(/\n|\r|\n\r/g,"");for(var d=s.split(", "),f=0;f<d.length;f++)t[d[f]]=o}}return t}function N(e){for(var t=e.split("v:shape"),r=1;r<t.length;r++){var i=t[r],n=i.split(' id="')[1];if(n&&n.length>1){n=n.split('"')[0];var l=i.split(' o:spid="')[1];l&&l.length>1&&(l=l.split('"')[0],M[n]=l)}}}function w(r,i){r=r.replace(/[.\s\S\w\W<>]*(<html[^>]*>[.\s\S\w\W<>]*<\/html>)[.\s\S\w\W<>]*/gi,"$1"),N(r);var n=new DOMParser,l=n.parseFromString(r,"text/html"),a=l.head,f=l.body,g=y(a);o(f,function(t){if(t.nodeType==Node.TEXT_NODE&&/\n|\u00a0/.test(t.data)){if(!/\S/.test(t.data))return t.data==e.FE.UNICODE_NBSP?(t.data="​",!0):(s(t),!1);t.data=t.data.replace(/\n/gi," ")}return!0}),o(f,function(e){return e.nodeType!=Node.ELEMENT_NODE||"V:IMAGEDATA"!=e.tagName&&"IMG"!=e.tagName||A(e,i),!0}),o(f,function(e){if(e.nodeType==Node.TEXT_NODE)return e.data=e.data.replace(/<br>(\n|\r)/gi,"<br>"),!1;if(e.nodeType==Node.ELEMENT_NODE){if(d(e)){var t=e.parentNode,r=e.previousSibling,i=u(e,g),n=null;return n=r?r.nextSibling:t.firstChild,n?t.insertBefore(i,n):t.appendChild(i),!1}return C(e,g)}return e.nodeType!=Node.COMMENT_NODE||(s(e),!1)}),o(f,function(e){if(e.nodeType==Node.ELEMENT_NODE){var t=e.tagName;if(!e.innerHTML&&-1==["BR","IMG"].indexOf(t)){for(var r=e.parentNode;r&&(s(e),e=r,!e.innerHTML);)r=e.parentNode;return!1}b(e)}return!0});var p=f.outerHTML,m=t.opts.htmlAllowedStyleProps;return t.opts.htmlAllowedStyleProps=t.opts.wordAllowedStyleProps,p=t.clean.html(p,t.opts.wordDeniedTags,t.opts.wordDeniedAttrs,!1),t.opts.htmlAllowedStyleProps=m,p}var T,S,x="word_paste",M={};return{_init:r,clean:a}}});