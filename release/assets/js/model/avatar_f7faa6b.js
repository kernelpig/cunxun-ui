function AvatarUploadChangeHandler(){if(this.files&&this.files.length){var a=window.urlObejct||window.webkitURL,t=this.files[0];/^image\/\w+$/.test(t.type)?(AvatarImageUrlObject=a.createObjectURL(t),AvatarImageBox.one("built.cropper",function(){a.revokeObjectURL(AvatarImageUrlObject)}).cropper("reset").cropper("replace",AvatarImageUrlObject)):AlertShowError("请选择图像文件类型")}}function AvatarUploadClickHandler(){""===AvatarImageBox.attr("src")?AlertShowError("没有选择上传的图片"):(AvatarImageBytes=$("#AvatarImageBox").cropper("getCroppedCanvas",{width:AvatarWidthDefault,height:AvatarHeightDefault}).toDataURL(),$("#AvatarUploadBox").modal("close"))}function AvatarImageRotateRight(){$("#AvatarImageBox").cropper("rotate",45)}function AvatarImageRotateLeft(){$("#AvatarImageBox").cropper("rotate",-45)}var AvatarTemplate='\n<!--图片上传框-->\n<div class="am-modal am-modal-no-btn up-frame-bj " tabindex="-1" id="AvatarUploadBox">\n  <div class="am-modal-dialog up-frame-parent up-frame-radius">\n	<div class="am-modal-hd up-frame-header">\n	   <label>修改头像</label>\n	  <a href="javascript: void(0)" class="am-close am-close-spin" data-am-modal-close>&times;</a>\n	</div>\n	<div class="am-modal-bd  up-frame-body">\n	  <div class="am-g am-fl">\n		<div class="am-form-group am-form-file">\n		  <div class="am-fl">\n			<button type="button" class="am-btn am-btn-default am-btn-sm">\n			  <i class="am-icon-cloud-upload"></i> 选择要上传的文件</button>\n		  </div>\n		  <input type="file" id="AvatarInputImageBox">\n		</div>\n	  </div>\n	  <div class="am-g am-fl" >\n		<div class="up-pre-before up-frame-radius">\n			<img alt="" src="" id="AvatarImageBox" >\n		</div>\n		<div class="up-pre-after up-frame-radius">\n		</div>\n	  </div>\n	  <div class="am-g am-fl">\n		<div class="up-control-btns">\n			<span class="am-icon-rotate-left"></span>\n			<span class="am-icon-rotate-right"></span>\n			<span class="am-icon-check" id="AvatarImageUploadButton"></span>\n		</div>\n	  </div>\n	</div>\n  </div>\n</div>\n\n<!--加载框-->\n<div class="am-modal am-modal-loading am-modal-no-btn" tabindex="-1" id="AvatarLoadingBox">\n  <div class="am-modal-dialog">\n	<div class="am-modal-hd">正在上传...</div>\n	<div class="am-modal-bd">\n	  <span class="am-icon-spinner am-icon-spin"></span>\n	</div>\n  </div>\n</div>',AvatarImageBox=null,AvatarImageUrlObject=null,AvatarImageBytes="";$(document).ready(function(){$("body").append(AvatarTemplate),AvatarImageBox=$("#AvatarImageBox").cropper({aspectRatio:"1",autoCropArea:.6,preview:".up-pre-after"}),$("#AvatarInputImageBox").change(AvatarUploadChangeHandler),$("#AvatarImageUploadButton").click(AvatarUploadClickHandler),$(".am-icon-rotate-left").click(AvatarImageRotateLeft),$(".am-icon-rotate-right").click(AvatarImageRotateRight)});