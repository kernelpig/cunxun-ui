function CarpoolingPageRender(){NavbarRender(),FootbarRender()}function CarpoolingCreateHandler(){var o={from_city:$(".CarpoolingFromCityField").val(),to_city:$(".CarpoolingToCityField").val(),depart_time:GetUnixTimestampOfSecond($(".CarpoolingDepartTimeField").val()),people_count:parseInt($(".CarpoolingPeopleCountField").val()),contact:$(".CarpoolingContactField").val(),remark:$(".CarpoolingRemarkField").val()||" "};APICarpoolingCreate(o,AlertShowAjaxError,function(o){0===o.code?AlertShowAutoCloseAndGoPage("创建成功","马上跳转当前页面!","/carpooling.html?carpooling_id="+o.id):AlertShowError(o.sub_error)})}function CarpoolingUpdateHandler(){var o={from_city:$(".CarpoolingFromCityField").val(),to_city:$(".CarpoolingToCityField").val(),depart_time:GetUnixTimestampOfSecond($(".CarpoolingDepartTimeField").val()),people_count:parseInt($(".CarpoolingPeopleCountField").val()),contact:$(".CarpoolingContactField").val(),remark:$(".CarpoolingRemarkField").val()||" "},e=GetURIParamStr(location.href,"carpooling_id");APICarpoolingUpdateById(e,o,AlertShowAjaxError,function(o){0===o.code?AlertShowAutoCloseAndGoPage("更新成功","马上跳转相关页面!","/carpooling.html?carpooling_id="+e):AlertShowError(o.sub_error)})}function CarpoolingEditorRender(){$(".CarpoolingRemarkField").froalaEditor({theme:"gray",height:200,language:"zh_cn",imageUploadParam:"image_key",imageUploadURL:imageBaseURI+"/",imageUploadParams:{xToken:Cookies.get("Authorization")},imageUploadMethod:"POST",imageMaxSize:imageUploadMaxSize,imageAllowedTypes:imageUploadTypes}).on("froalaEditor.image.error",froalaEditorImageUploadErrorHandler)}function CarpoolingDepartTimeRender(o){$.fn.datetimepicker.dates["zh-CN"]={days:["星期日","星期一","星期二","星期三","星期四","星期五","星期六","星期日"],daysShort:["周日","周一","周二","周三","周四","周五","周六","周日"],daysMin:["日","一","二","三","四","五","六","日"],months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthsShort:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],today:"今天",suffix:[],meridiem:["上午","下午"]},$(".CarpoolingDepartTimeField").datetimepicker({format:"yyyy-mm-dd hh:ii:ss",language:"zh-CN",autoclose:!0,initialDate:o})}function CarpoolingCreateRender(){CarpoolingDepartTimeRender(new Date),CarpoolingEditorRender(),$(".CarpoolingActionHandler").click(CarpoolingCreateHandler)}function CarpoolingUpdateRender(){var o={carpooling_id:GetURIParamStr(location.href,"carpooling_id")};APICarpoolingGetItem(o,AlertShowAjaxError,function(o){if(0===o.code){if(!o.list||o.list.length<=0)return void AlertShowAutoClose("不存在","此拼车不存在");var e=o.list[0];$(".CarpoolingFromCityField").val(e.from_city),$(".CarpoolingToCityField").val(e.to_city),$(".CarpoolingDepartTimeField").val(CtsTimeFormat(e.depart_time)),$(".CarpoolingPeopleCountField").val(e.people_count),$(".CarpoolingContactField").val(e.contact),$(".CarpoolingRemarkField").html(parseSpecialChar(e.remark)),CarpoolingEditorRender(),CarpoolingDepartTimeRender(CtsTimeFormat(e.depart_time)),$(".CarpoolingActionHandler").click(CarpoolingUpdateHandler)}else AlertShowError(o.sub_error)})}$(document).ready(function(){CarpoolingPageRender();var o=GetURIParamStr(location.href,"action");"create"===o?CarpoolingCreateRender():"update"===o&&CarpoolingUpdateRender(),$(".am-form").validator(formValidator)});